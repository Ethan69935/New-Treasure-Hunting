<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯»å®å¤§å†’é™© - å…¨æ™¯åœ°å›¾</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <h1>ğŸ´â€â˜ ï¸ å¯»å®å¤§å†’é™©</h1>
        
        <!-- çŠ¶æ€é¢æ¿ -->
        <div class="status-panel">
            <p>é‡‘å¸: <span id="gold">50</span> | æ‰“æ‰‹: <span id="helpers">0</span>äºº | çº¿ç´¢: <span id="clue">æœªæ‰¾åˆ°</span></p>
            <!-- éŸ³ä¹å¼€å…³æŒ‰é’® -->
            <button class="music-toggle" onclick="toggleMusic()">ğŸµ éŸ³ä¹ï¼šå¼€å¯</button>
        </div>
        
        <!-- å…¨æ™¯åœ°å›¾åŒºåŸŸ -->
        <div class="panorama">
            <div class="location" id="library" data-page="library.html">
                <div class="icon">ğŸ“š</div>
                <h3>å¤è€å›¾ä¹¦é¦†</h3>
                <p>å¯»æ‰¾å®è—çº¿ç´¢</p>
                <div class="location-status">çŠ¶æ€: <span id="library-status">å¯æ¢ç´¢</span></div>
            </div>
            
            <div class="location locked" id="tavern" data-page="tavern.html">
                <div class="icon">ğŸº</div>
                <h3>çŒäººé…’é¦†</h3>
                <p>é›‡ä½£æ‰“æ‰‹</p>
                <div class="location-status">çŠ¶æ€: <span id="tavern-status">æœªè§£é”</span></div>
            </div>
            
            <div class="location locked" id="temple" data-page="temple.html">
                <div class="icon">ğŸ›ï¸</div>
                <h3>ç¥ç§˜ç¥åº™</h3>
                <p>æ¢ç´¢å®è—</p>
                <div class="location-status">çŠ¶æ€: <span id="temple-status">æœªè§£é”</span></div>
            </div>
            
            <div class="location locked" id="exit" data-page="exit.html">
                <div class="icon">ğŸšª</div>
                <h3>ç¥åº™å‡ºå£</h3>
                <p>ç»“ç®—å†’é™©</p>
                <div class="location-status">çŠ¶æ€: <span id="exit-status">æœªè§£é”</span></div>
            </div>
        </div>
    </div>

    <!-- å…¨æ™¯é¡µèƒŒæ™¯éŸ³ä¹ï¼ˆ8-bitå†’é™©é£æ ¼ï¼‰ -->
    <audio id="bg-music" loop>
        <source src="https://mixkit.co/music/preview/mixkit-8bit-adventure-game-loop-2570.mp3" type="audio/mpeg">
    </audio>

    <script src="js/game.js"></script>
    <script>
        const gameState = loadGameState();
        updateUI();

        // éŸ³ä¹å…ƒç´ ä¸çŠ¶æ€åˆå§‹åŒ–
        const music = document.getElementById('bg-music');
        music.volume = 0.2; // éŸ³é‡è°ƒè‡³20%
        updateMusicButton(); // åŒæ­¥æŒ‰é’®æ˜¾ç¤ºçŠ¶æ€

        // ç»‘å®šåœ°ç‚¹ç‚¹å‡»äº‹ä»¶
        document.querySelectorAll('.location').forEach(location => {
            location.addEventListener('click', () => {
                const targetPage = location.dataset.page;
                enterScene(targetPage);
            });
        });

        // é¦–æ¬¡ç‚¹å‡»é¡µé¢è§¦å‘éŸ³ä¹æ’­æ”¾ï¼ˆè§£å†³æµè§ˆå™¨é™åˆ¶ï¼‰
        document.body.addEventListener('click', playMusicOnFirstClick, { once: true });

        // éŸ³ä¹æ§åˆ¶å‡½æ•°
        function playMusicOnFirstClick() {
            if (gameState.musicEnabled && music.paused) {
                music.play().catch(e => console.log('éŸ³ä¹éœ€ç‚¹å‡»åæ’­æ”¾'));
            }
        }

        function toggleMusic() {
            gameState.musicEnabled = !gameState.musicEnabled;
            if (gameState.musicEnabled) {
                music.play();
            } else {
                music.pause();
            }
            updateMusicButton();
            saveGameState();
        }

        function updateMusicButton() {
            const btn = document.querySelector('.music-toggle');
            btn.textContent = gameState.musicEnabled ? 'ğŸµ éŸ³ä¹ï¼šå¼€å¯' : 'ğŸµ éŸ³ä¹ï¼šå…³é—­';
        }
    </script>
</body>
</html>
